---
import '../styles/global.css';
import '@fontsource/inter/400.css';
import '@fontsource/inter/500.css';
import '@fontsource/inter/600.css';
import '@fontsource/inter/700.css';
import '@fontsource/jetbrains-mono/400.css';

const { title, description } = Astro.props;
const currentPath = Astro.url.pathname;

function isActive(path: string): string {
  if (path === '/' && currentPath === '/') return 'active';
  if (path !== '/' && currentPath.startsWith(path)) return 'active';
  return '';
}
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <title>{title}</title>
  </head>
  <body>
    <nav class="fixed top-0 left-0 right-0 z-50 border-b backdrop-blur-xl bg-primary border-color">
      <div class="max-w-7xl mx-auto px-6">
        <div class="flex items-center justify-between h-16">
          <a href="/" class="text-lg font-bold gradient-text">yasin.dev</a>

          <div class="hidden md:flex items-center space-x-8">
            <a href="/" class="nav-link {isActive('/')}">Home</a>
            <a href="/portfolio" class="nav-link {isActive('/portfolio')}">Portfolio</a>
            <a href="/blog" class="nav-link {isActive('/blog')}">Blog</a>
          </div>

          <div class="flex items-center gap-4">
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme"></button>
            <button id="menu-btn" class="md:hidden p-2 text-secondary">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div id="mobile-menu" class="hidden md:hidden border-t bg-primary border-color">
        <div class="px-6 py-4 space-y-4">
          <a href="/" class="block nav-link {isActive('/')}">Home</a>
          <a href="/portfolio" class="block nav-link {isActive('/portfolio')}">Portfolio</a>
          <a href="/blog" class="block nav-link {isActive('/blog')}">Blog</a>
        </div>
      </div>
    </nav>

    <main class="pt-16">
      <slot />
    </main>

    <script>
      const themeToggle = document.getElementById('theme-toggle');
      const html = document.documentElement;
      const savedTheme = localStorage.getItem('theme') || 'dark';
      html.setAttribute('data-theme', savedTheme);

      themeToggle?.addEventListener('click', () => {
        const currentTheme = html.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
      });

      const menuBtn = document.getElementById('menu-btn');
      const mobileMenu = document.getElementById('mobile-menu');

      menuBtn?.addEventListener('click', () => {
        mobileMenu?.classList.toggle('hidden');
      });

      mobileMenu?.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
          mobileMenu.classList.add('hidden');
        });
      });
    </script>
  </body>
</html>
